package de.NDN.app.writeInvoice.document.print;

import java.awt.print.Book;
import java.awt.print.PageFormat;
import java.awt.print.Printable;
import java.awt.print.PrinterException;
import java.awt.print.PrinterJob;
import java.util.ArrayList;

public class DocumentInvoicePrinter {
	
	private Book book;
	private ArrayList<Printable> printableDocuments;
	
	public DocumentInvoicePrinter(ArrayList<Printable> printableDocuments) {
		this.printableDocuments = printableDocuments;
	}	
	
	public void doPrint() {
		PrinterJob job = PrinterJob.getPrinterJob();
		
		for(Printable printableDocument : this.printableDocuments) {
			PageFormat test = ((DocumentInvoicePrintable) printableDocument).getPageFormat();
			this.book.append( printableDocument, job.defaultPage() );
		}
		
        job.setPageable(this.book);
        boolean ok = job.printDialog();
        if (ok) {
            try {
                 job.print();
            } catch (PrinterException ex) {
             /* The job did not successfully complete */
            }
        }
	}
	
}
