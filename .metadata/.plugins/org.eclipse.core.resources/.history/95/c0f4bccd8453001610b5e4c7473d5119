package de.NDN.app.writeInvoice.document.print;

import java.awt.Canvas;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.MediaTracker;
import java.awt.Shape;
import java.awt.print.PageFormat;
import java.awt.print.Printable;
import java.awt.print.PrinterException;
import java.util.ArrayList;

public class DocumentInvoicePrintable implements Printable {
	
	private ArrayList<Shape> pageShapes;
	private ArrayList<Object[]> pageImages;
	
	@Override
	public int print(Graphics graphics, PageFormat pageFormat, int pageIndex) throws PrinterException {		
		if (pageIndex > 0) {
	         return NO_SUCH_PAGE;
	    }
		
		Graphics2D graphics2D = (Graphics2D) graphics;
		double a = pageFormat.getImageableX();
		double b = pageFormat.getImageableY();
		graphics2D.translate(pageFormat.getImageableX(), pageFormat.getImageableY());
		
		for(Shape shape : pageShapes) {
			graphics2D.draw(shape);
		}
		for(Object[] imgAndInfos : pageImages) {
			Image image = (Image) imgAndInfos[0];
			
			MediaTracker tracker = new MediaTracker( new Canvas() );
			tracker.addImage(image, 0);			
			try {
				tracker.waitForID(0);
			} catch (InterruptedException e) {
				e.printStackTrace();
			}	
			
			int fullImgWidth = image.getWidth(null);
			int fullImgHeight = image.getHeight(null);
			
			if( fullImgWidth != -1 && fullImgWidth != 0 && fullImgHeight != -1 && fullImgHeight != 0 ) {
				
				int ratio = fullImgWidth / fullImgHeight;
				int desiredImgWidth = (int) imgAndInfos[1];
				int desiredImgHeight = (int) imgAndInfos[2];
				
				if( desiredImgWidth == -1 ) 
				
				graphics2D.drawImage(image, 0, 0, 200, 50, null);
			}			
		}
		
		
		
		//Image img = new ImageIcon("companyLogo.png").getImage();
//		Image img = Toolkit.getDefaultToolkit().getImage("companyLogo.png");
//		int imgWidth = img.getWidth(null);
//		int imgHeight = img.getHeight(null);
//		graphics2D.drawImage(img, 0, 0, img.getWidth(null), img.getHeight(null), null);
		
		
		
		return Printable.PAGE_EXISTS;
	}

	public ArrayList<Shape> getPageShapes() {
		return pageShapes;
	}

	public void setPageShapes(ArrayList<Shape> pageShapes) {
		this.pageShapes = pageShapes;
	}

	public ArrayList<Object[]> getPageImages() {
		return pageImages;
	}

	public void setPageImages(ArrayList<Object[]> pageImages) {
		this.pageImages = pageImages;
	}

}
